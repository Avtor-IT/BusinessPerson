import{k as p,r as n,o as h,j as r,l as f}from"./index-CF0m55Cn.js";import{u as x}from"./useMutation-DXAfmjBV.js";const j="_loginForm_17urm_1",l={loginForm:j},w=async t=>{try{const e=await p("JWT_CREATE","POST",t);return e!=null&&e.access?(sessionStorage.setItem("access",e.access),sessionStorage.setItem("refresh",e.refresh),e.access):e}catch(e){throw console.error("Login failed:",e),e.response.status===401?Error("Unauthorized"):Error(e.response.status)}},E=()=>x({mutationFn:async t=>await w(t)}),S=()=>{const[t,e]=n.useState(""),[i,u]=n.useState(""),[d,o]=n.useState(""),c=h(),s=E(),g=a=>{if(a&&a.preventDefault(),!t||!i){o("Введите имя и пароль");return}const m={username:t,password:i};s.mutate(m)};return n.useEffect(()=>{if(s.error){s.error.message==="Unauthorized"?o("Пользователь не найден"):(console.error(s.error),o("Ошибка при входе в аккаунт. Повторите попытку позже."));return}s.data&&c("/",{replace:!0})},[s,c]),r.jsx(f,{className:l.LoginPage,children:r.jsxs("form",{className:l.loginForm,onSubmit:g,children:[r.jsxs("label",{children:["Login:"," ",r.jsx("input",{type:"text",placeholder:"enter login",onChange:a=>e(a.target.value),disabled:s.isPending,required:!0})]}),r.jsx("br",{}),r.jsxs("label",{children:["Password:"," ",r.jsx("input",{type:"password",placeholder:"enter password",onChange:a=>u(a.target.value),disabled:s.isPending,required:!0})]}),r.jsx("p",{children:d}),r.jsx("p",{children:s.isPending?"Вход в аккаунт...":""}),r.jsx("button",{disabled:s.isPending,children:"Enter"})]})})};export{S as default};

import{N as h,Q as m,U as x,V as f,r as n,W as j,j as r,M as w}from"./index-Df1ayVmF.js";const E="_loginForm_17urm_1",u={loginForm:E},P=async t=>{try{const e=await h("JWT_CREATE","POST",t);return e!=null&&e.access?(sessionStorage.setItem("access",e.access),sessionStorage.setItem("refresh",e.refresh),e.access):e}catch(e){throw console.error("Login failed:",e),e.response.status===401?Error("Unauthorized"):Error(e.response.status)}},b=()=>{const t=m();return x({mutationFn:async e=>await P(e),onSuccess:e=>{t(f(e))}})},L=()=>{const[t,e]=n.useState(""),[i,l]=n.useState(""),[d,o]=n.useState(""),c=j(),s=b(),g=a=>{if(a&&a.preventDefault(),!t||!i){o("Введите имя и пароль");return}const p={username:t,password:i};s.mutate(p)};return n.useEffect(()=>{if(s.error){s.error.message==="Unauthorized"?o("Пользователь не найден"):(console.error(s.error),o("Ошибка при входе в аккаунт. Повторите попытку позже."));return}s.data&&c("/",{replace:!0})},[s,c]),r.jsx(w,{className:u.LoginPage,children:r.jsxs("form",{className:u.loginForm,onSubmit:g,children:[r.jsxs("label",{children:["Login:"," ",r.jsx("input",{type:"text",placeholder:"enter login",onChange:a=>e(a.target.value),disabled:s.isPending,required:!0})]}),r.jsx("br",{}),r.jsxs("label",{children:["Password:"," ",r.jsx("input",{type:"password",placeholder:"enter password",onChange:a=>l(a.target.value),disabled:s.isPending,required:!0})]}),r.jsx("p",{children:d}),r.jsx("p",{children:s.isPending?"Вход в аккаунт...":""}),r.jsx("button",{disabled:s.isPending,children:"Enter"})]})})};export{L as default};
